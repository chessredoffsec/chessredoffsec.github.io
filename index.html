<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Madurez AppSec LATAM</title>

<meta http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline';
               object-src 'none'; base-uri 'none'; frame-ancestors 'none'">

<style>
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;padding:20px;line-height:1.4}
.wrap{max-width:900px;margin:auto}
.card{border:1px solid #ccc;border-radius:14px;padding:16px;margin-bottom:16px}
h1{margin:0 0 6px;font-size:1.3rem}
.sub{opacity:.85;margin:0 0 6px}
.signature{font-size:.9rem;opacity:.85;margin-bottom:14px}
label{font-weight:700}
select,button{font:inherit;padding:10px 12px;border-radius:10px;border:1px solid #aaa}
button{cursor:pointer}
button:disabled{opacity:.5;cursor:not-allowed}
.q{margin-top:14px;padding-top:12px;border-top:1px dashed #ccc}
.opt{display:flex;gap:10px;padding:8px;border:1px solid #ddd;border-radius:10px;margin-top:6px;align-items:flex-start}
.score{font-size:1.1rem;font-weight:800}
.badge{display:inline-block;padding:6px 10px;border:1px solid #aaa;border-radius:999px;font-weight:700}
.muted{opacity:.8;font-size:.9rem;margin:10px 0 0}
table{width:100%;border-collapse:collapse}
td,th{padding:6px;border-bottom:1px solid #ddd;text-align:left}
</style>
</head>

<body>
<div class="wrap">

<h1>Madurez AppSec LATAM</h1>
<p class="sub">Evaluación de madurez en desarrollo seguro · 10 preguntas · Nota 0–10</p>
<p class="signature">By <strong>ChessRedOffsec</strong> · Apoyo <strong>Hacktiba LATAM</strong></p>

<div class="card">
<label for="country">Selecciona tu país (solo para conteo en pantalla):</label><br><br>

<select id="country">
<option value="">— seleccionar —</option>
<option>Ecuador</option>
<option>Uruguay</option>
<option>México</option>
<option>Costa Rica</option>
<option>Panamá</option>
<option>Argentina</option>
<option>Bolivia</option>
<option>Chile</option>
<option>Colombia</option>
<option>Paraguay</option>
<option>Perú</option>
<option>Venezuela</option>
</select>

<button id="startBtn" type="button">Comenzar</button>

<p class="muted">
Privacidad: no se recolectan datos personales ni de empresa.
No cookies, no storage, no envío de datos.
</p>
</div>

<form id="quiz" class="card" style="display:none" autocomplete="off" novalidate>
<div id="questions"></div>
<br>
<button type="submit" id="submitBtn" disabled>Ver resultado</button>
<button type="button" id="resetBtn">Limpiar</button>
</form>

<div id="result" class="card" style="display:none">
<div class="score" id="score"></div>
<div id="level"></div>
<p class="muted" id="hint"></p>

<h3 style="margin:16px 0 8px">Respondentes por país (sesión actual)</h3>
<table><tbody id="counts"></tbody></table>

<p class="muted">El conteo existe solo mientras la página esté abierta (RAM).</p>
</div>

</div>

<script>
"use strict";

const QUESTIONS = [
  "¿Existe un plan estratégico formal de AppSec?",
  "¿Se realizan pentests de forma regular?",
  "¿Las aplicaciones están protegidas por WAF o controles perimetrales?",
  "¿Existen prácticas de seguridad para adopción de IA?",
  "¿Hay entrenamientos de seguridad para desarrolladores?",
  "¿Se aplican prácticas de seguridad directamente en la IDE?",
  "¿Las aplicaciones cloud siguen prácticas de seguridad definidas?",
  "¿Existen controles de seguridad en las pipelines CI/CD?",
  "¿Se miden métricas y KPIs de seguridad para mejorar el flujo?",
  "¿Existen requisitos de seguridad y modelado de amenazas?"
];

const ANSWERS = [
  ["Inicial (0)", 0],
  ["Intermedio (0,5)", 0.5],
  ["Avanzado (1)", 1]
];

const state = {
  country: "",
  scores: new Array(QUESTIONS.length).fill(null),
  counts: {}
};

const $ = id => document.getElementById(id);

function answeredAll(){
  return state.scores.every(v => v !== null);
}

function renderQuestions(){
  const box = $("questions");
  box.innerHTML = "";

  QUESTIONS.forEach((q, i) => {
    const div = document.createElement("div");
    div.className = "q";

    div.innerHTML = `<strong>${q}</strong>`;

    ANSWERS.forEach(([label, value]) => {
      const lbl = document.createElement("label");
      lbl.className = "opt";

      const input = document.createElement("input");
      input.type = "radio";
      input.name = `q${i}`;
      input.addEventListener("change", () => {
        state.scores[i] = value;
        $("submitBtn").disabled = !answeredAll();
      });

      const text = document.createElement("div");
      text.textContent = label;

      lbl.appendChild(input);
      lbl.appendChild(text);
      div.appendChild(lbl);
    });

    box.appendChild(div);
  });
}

function classify(score){
  if(score <= 3.5) return ["Básico", "Prioriza fundamentos: controles mínimos, visibilidad y disciplina."];
  if(score <= 7.0) return ["En evolución", "Buen progreso: estandariza prácticas y refuerza controles."];
  return ["Maduro", "Excelente: foco en consistencia, métricas y mejora continua."];
}

function renderCounts(){
  const tb = $("counts");
  tb.innerHTML = "";
  Object.entries(state.counts).forEach(([c,n])=>{
    tb.innerHTML += `<tr><td>${c}</td><td>${n}</td></tr>`;
  });
}

$("startBtn").addEventListener("click", () => {
  const c = $("country").value;
  if(!c) return alert("Selecciona un país para comenzar.");

  state.country = c;
  state.scores.fill(null);

  $("quiz").reset();
  $("quiz").style.display = "block";
  $("result").style.display = "none";
  $("submitBtn").disabled = true;

  renderQuestions();
});

$("resetBtn").addEventListener("click", () => {
  state.scores.fill(null);
  $("quiz").reset();
  $("submitBtn").disabled = true;
  $("result").style.display = "none";
});

$("quiz").addEventListener("submit", e => {
  e.preventDefault();

  if(!answeredAll()) return alert("Responde las 10 preguntas.");

  const total = Math.round(state.scores.reduce((a,b)=>a+b,0)*10)/10;
  const [lvl,hint] = classify(total);

  state.counts[state.country] = (state.counts[state.country]||0)+1;

  $("score").textContent = `Nota: ${total} / 10`;
  $("level").innerHTML = `<span class="badge">Nivel: ${lvl}</span>`;
  $("hint").textContent = hint;

  renderCounts();
  $("result").style.display = "block";
});
</script>

</body>
</html>
